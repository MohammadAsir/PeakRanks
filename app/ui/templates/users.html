{% extends 'base.html' %}
{% block content %}
  <h2>All Users</h2>
  <ul class="list-group">
    {% for u in users %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <a href="{{ url_for('main.user_profile', user_id=u.id) }}">{{ u.username }}</a>
        {% if current_user.is_authenticated and u.id != current_user.id %}
          {% set rel = u in [f.requested for f in current_user.friendships] %}
          <form method="post" action="{{ url_for('main.add_friend', user_id=u.id) }}">
            <button class="btn btn-sm btn-primary" {% if rel %}disabled{% endif %}>
              {{ 'Requested' if rel else 'Add Friend' }}
            </button>
          </form>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% endblock %}
